import{_ as N,r as d,c as _,o as P,a as T,b as E,d as e,w as i,v as r,e as k,t as O,f as L,g as h,h as U,F as I,i as G,j as H,k as A,l as R,m as D}from"./index-BfHCVPAw.js";import{_ as j}from"./icon-BMzdE3NH.js";const M={class:"flex flex-col h-full justify-between"},F={class:"config-editor w-full grow place-content-center"},V={class:"main-layout"},$={class:"config-column"},B={class:"config-section"},J={class:"form-group"},X={class:"form-group"},K={class:"form-group"},W={for:"threshold"},Y={class:"config-section"},Z={class:"form-group"},q={class:"path-input-group"},z={class:"form-group"},Q={class:"path-input-group"},ee={class:"form-group"},te={class:"form-group"},se={class:"form-group"},oe={class:"preview-column"},le={class:"preview-section"},ne={__name:"settings",setup(S){const p={LANGUAGE_MODE:"c",LOG_DIR:"D:\\Code\\UnitTestGen\\logs",LLM_LOG_DIR:"D:\\Code\\UnitTestGen\\logs\\llm_logs",REPO_PATH:"D:\\Code\\UnitTestGen\\sxiv",CUSTOMIZED_TESTCODE_PATH:[],EXCEPTE_PATH:["D:\\Code\\UnitTestGen\\fzy\\deps"],RESOLVED_METAINFO_PATH:["D:\\Code\\UnitTestGen\\data\\"],ALL_METAINFO_PATH:"D:\\Code\\UnitTestGen\\data\\all_metainfo.json",FUNCTION_METAINFO_PATH:"D:\\Code\\UnitTestGen\\data\\function_metainfo.json",TESTCASE_METAINFO_PATH:"D:\\Code\\UnitTestGen\\data\\testcase_metainfo.json",UDT_METAINFO_PATH:"D:\\Code\\UnitTestGen\\data\\udt_metainfo.json",GLOBAL_VARIABLE_METAINFO_PATH:"D:\\Code\\UnitTestGen\\data\\global_variable_metainfo.json",FUNCTION_SIMILARITY_PATH:"D:\\Code\\UnitTestGen\\data\\function_similarity.json",TESTCASE_ANALYSIS_RESULT_PATH:"D:\\Code\\UnitTestGen\\data\\testcase_analysis_result.json",CONTEXT_ANALYSIS_RESULT_PATH:"D:\\Code\\UnitTestGen\\data\\context_analysis_result.json",GENERATION_RESULT_PATH:"D:\\Code\\UnitTestGen\\results\\",REFERENCE_THRESHOLD:.8,UNITTEST_FRAMEWORK:"Unity"},o=d(JSON.parse(JSON.stringify(p))),f=d(null),v=d(""),u=d(!1),b=_({get:()=>o.value.CUSTOMIZED_TESTCODE_PATH.join(`
`),set:l=>{o.value.CUSTOMIZED_TESTCODE_PATH=l.split(`
`).filter(t=>t.trim())}}),g=_({get:()=>o.value.RESOLVED_METAINFO_PATH.join(`
`),set:l=>{o.value.RESOLVED_METAINFO_PATH=l.split(`
`).filter(t=>t.trim())}}),y=_({get:()=>o.value.EXCEPTE_PATH.join(`
`),set:l=>{o.value.EXCEPTE_PATH=l.split(`
`).filter(t=>t.trim())}}),c=_(()=>JSON.stringify(o.value,null,2)),s=l=>{v.value=l,f.value.click()},x=l=>{const t=l.target.files;if(t.length>0){const n=t[0].path||t[0].webkitRelativePath.split("/")[0];o.value[v.value]=n}l.target.value=""},m=async()=>{try{u.value=!0;const l=await fetch("/config");if(!l.ok)throw new Error("获取配置失败");const t=await l.json();t&&(o.value={...p,...t},toast.success("配置加载成功"))}catch(l){console.error("获取配置出错:",l),toast.error("获取配置失败，使用默认配置")}finally{u.value=!1}},a=async()=>{try{u.value=!0;const l=await fetch("/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o.value)});if(!l.ok)throw new Error("保存配置失败");const t=await l.json();toast.success("配置保存成功"),console.log("配置保存结果:",t)}catch(l){console.error("保存配置出错:",l),toast.error("保存配置失败")}finally{u.value=!1}},C=()=>{const l=new Blob([c.value],{type:"application/json"}),t=URL.createObjectURL(l),n=document.createElement("a");n.href=t,n.download="unitTestGen_config.json",n.click(),URL.revokeObjectURL(t),alert("配置已保存")},w=()=>{confirm("确定要重置为默认配置吗？")&&(o.value=JSON.parse(JSON.stringify(p)))};return P(()=>{m()}),(l,t)=>(E(),T("div",M,[e("div",F,[e("div",V,[e("div",$,[e("section",B,[t[13]||(t[13]=e("h2",null,"核心参数",-1)),e("div",J,[t[10]||(t[10]=e("label",{for:"language-mode"},"语言模式:",-1)),i(e("input",{id:"language-mode",type:"text","onUpdate:modelValue":t[0]||(t[0]=n=>o.value.LANGUAGE_MODE=n),readonly:""},null,512),[[r,o.value.LANGUAGE_MODE]])]),e("div",X,[t[12]||(t[12]=e("label",{for:"test-framework"},"测试框架:",-1)),i(e("select",{id:"test-framework","onUpdate:modelValue":t[1]||(t[1]=n=>o.value.UNITTEST_FRAMEWORK=n)},t[11]||(t[11]=[e("option",{value:"Unity"},"Unity",-1),e("option",{value:"Google Test"},"Google Test",-1),e("option",{value:"Catch2"},"Catch2",-1)]),512),[[k,o.value.UNITTEST_FRAMEWORK]])]),e("div",K,[e("label",W,"相似度阈值 ("+O(o.value.REFERENCE_THRESHOLD)+"):",1),i(e("input",{id:"threshold",type:"range",min:"0",max:"1",step:"0.05","onUpdate:modelValue":t[2]||(t[2]=n=>o.value.REFERENCE_THRESHOLD=n)},null,512),[[r,o.value.REFERENCE_THRESHOLD,void 0,{number:!0}]])])]),e("section",Y,[t[19]||(t[19]=e("h2",null,"路径配置",-1)),e("div",Z,[t[14]||(t[14]=e("label",{for:"repo-path"},"代码仓库路径:",-1)),e("div",q,[i(e("input",{id:"repo-path",type:"text","onUpdate:modelValue":t[3]||(t[3]=n=>o.value.REPO_PATH=n),readonly:""},null,512),[[r,o.value.REPO_PATH]]),e("button",{onClick:t[4]||(t[4]=n=>s("REPO_PATH"))},"浏览")])]),e("div",z,[t[15]||(t[15]=e("label",{for:"log-dir"},"日志目录:",-1)),e("div",Q,[i(e("input",{id:"log-dir",type:"text","onUpdate:modelValue":t[5]||(t[5]=n=>o.value.LOG_DIR=n),readonly:""},null,512),[[r,o.value.LOG_DIR]]),e("button",{onClick:t[6]||(t[6]=n=>s("LOG_DIR"))},"浏览")])]),e("div",ee,[t[16]||(t[16]=e("label",null,"已有测试用例路径 (每行一个):",-1)),i(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=n=>b.value=n),rows:"3"},null,512),[[r,b.value]])]),e("div",te,[t[17]||(t[17]=e("label",null,"中间结果目录 (每行一个):",-1)),i(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=n=>g.value=n),rows:"3"},null,512),[[r,g.value]])]),e("div",se,[t[18]||(t[18]=e("label",null,"排除路径 (每行一个):",-1)),i(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=n=>y.value=n),rows:"3"},null,512),[[r,y.value]])])])]),e("div",oe,[e("section",le,[t[20]||(t[20]=e("h2",null,"配置预览",-1)),e("pre",null,O(c.value),1)])])]),e("div",{class:"action-buttons"},[e("button",{onClick:a,class:"save-btn"},"保存配置"),e("button",{onClick:w,class:"reset-btn"},"重置"),e("button",{onClick:C,class:"export-btn"},"导出为文件")]),e("input",{type:"file",ref_key:"directoryInput",ref:f,style:{display:"none"},webkitdirectory:"",onChange:x},null,544)])]))}},ae=N(ne,[["__scopeId","data-v-35daa6d6"]]),ie={class:"min-h-screen w-screen place-content-center flex justify-center items-center"},re={class:"w-3/5 h-full mx-auto bg-white rounded-2xl shadow-lg p-8 space-y-6 mb-10"},de={class:"space-y-4"},ue={class:"flex items-center space-x-2"},ce={class:"cursor-pointer h-10 bg-base-300 px-3 pt-2 rounded hover:bg-blue-400"},pe={key:0,class:"space-y-1"},fe={class:"truncate"},ve=["onClick"],me={class:"flex items-center space-x-2 justify-start ml-1 mt-6"},_e={class:"flex justify-between items-center"},Te={class:"drawer"},Ee={class:"drawer-side"},be={class:"menu bg-white w-3/4 p-4"},xe={__name:"main",setup(S){const p=d(""),o=d(""),f=d(""),v=d(!1),u=d([]),b=_(()=>o.value.trim()!==""&&f.value.trim()!==""),g=c=>{const s=c.target.files;if(s.length>0){const m=s[0].webkitRelativePath.split("/").slice(0,-1).join("/");p.value=m}c.target.value=""},y=c=>{u.value.splice(c,1)};return(c,s)=>{const x=D("el-button"),m=D("router-link");return E(),T("div",ie,[e("div",re,[s[13]||(s[13]=L('<div class="flex items-center justify-center"><img src="'+j+'" alt="LOGO" class="w-48"><h1 class="text-3xl font-bold text-center pt-8">AeroTest 航宇智测</h1></div><div class="text-right -mt-2"><p class="text-gray-500 italic mt-1">——基于大语言模型的航空航天软件测试生成</p></div>',2)),e("div",de,[e("div",null,[s[5]||(s[5]=e("label",{class:"block font-semibold mb-1"},"仓库路径",-1)),e("div",ue,[i(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=a=>p.value=a),class:"flex-1 border rounded-lg px-3 py-2",placeholder:"请输入路径"},null,512),[[r,p.value]]),e("label",ce,[s[4]||(s[4]=U(" 📁 ")),e("input",{type:"file",onChange:g,webkitdirectory:"",directory:"",class:"hidden"},null,32)])])]),u.value.length?(E(),T("div",pe,[(E(!0),T(I,null,G(u.value,(a,C)=>(E(),T("div",{key:C,class:"flex justify-between items-center bg-gray-100 px-3 py-2 rounded-lg"},[e("span",fe,O(a.name),1),e("div",{onClick:w=>y(C),class:"cursor-pointer text-white bg-red-500 rounded-full w-5 h-5 flex items-center justify-center text-sm hover:bg-red-600",title:"删除文件"}," × ",8,ve)]))),128))])):h("",!0),e("div",null,[s[6]||(s[6]=e("label",{class:"block font-semibold mb-1"},"测试函数名",-1)),i(e("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=a=>o.value=a),class:"w-full border rounded-lg px-3 py-2",placeholder:"输入函数名"},null,512),[[r,o.value]])]),e("div",null,[s[7]||(s[7]=e("label",{class:"block font-semibold mb-1"},"所在文件名",-1)),i(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=a=>f.value=a),class:"w-full border rounded-lg px-3 py-2",placeholder:"输入文件名"},null,512),[[r,f.value]])]),e("div",me,[i(e("input",{type:"checkbox",id:"enableAnalysis","onUpdate:modelValue":s[3]||(s[3]=a=>v.value=a),class:"w-5 h-5"},null,512),[[H,v.value]]),s[8]||(s[8]=e("label",{for:"enableAnalysis",class:"font-semibold"},"开启参照分析",-1))])]),e("div",_e,[e("div",Te,[s[10]||(s[10]=e("input",{id:"my-drawer",type:"checkbox",class:"drawer-toggle"},null,-1)),s[11]||(s[11]=e("div",{class:"drawer-content flex justify-end mr-5"},[e("label",{for:"my-drawer",class:"el-button"},"配置")],-1)),e("div",Ee,[s[9]||(s[9]=e("label",{for:"my-drawer","aria-label":"close sidebar",class:"drawer-overlay"},null,-1)),e("ul",be,[A(ae)])])]),A(m,{to:{name:"result",query:{function_name:o.value,file_name:f.value,reference:v.value}},custom:""},{default:R(({navigate:a})=>[A(x,{onClick:a,class:"bg-blue-600 text-white px-6 py-2 rounded-xl hover:bg-blue-700",disabled:!b.value},{default:R(()=>s[12]||(s[12]=[U(" 开始分析 ")])),_:2},1032,["onClick","disabled"])]),_:1},8,["to"])])])])}}};export{xe as default};
